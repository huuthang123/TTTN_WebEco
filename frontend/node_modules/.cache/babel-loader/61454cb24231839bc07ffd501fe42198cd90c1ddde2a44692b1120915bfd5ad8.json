{"ast":null,"code":"// src/services/CartService.js\nconst BASE_URL='http://localhost:5000/api/carts';// Hàm ánh xạ size từ giá trị UI (\"25\", \"5\", \"1\") sang giá trị backend (\"0.25\", \"0.5\", \"1\")\nconst mapSize=size=>{switch(size){case\"25\":return\"0.25\";case\"5\":return\"0.5\";case\"1\":return\"1\";case\"0.25\":return\"0.25\";case\"0.5\":return\"0.5\";case\"1.0\":return\"1\";default:throw new Error(`Size không hợp lệ: ${size}. Chỉ hỗ trợ \"25\" (0.25kg), \"5\" (0.5kg), \"1\" (1kg)`);}};// Lấy giỏ hàng theo userId\nexport async function fetchCart(userId){try{if(!userId)throw new Error('Thiếu userId');console.log('Fetching cart for userId:',userId);const response=await fetch(`${BASE_URL}/${userId}`);if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'Lỗi khi lấy giỏ hàng');}const data=await response.json();return data;}catch(error){console.error('Error fetching cart:',error.message);throw error;}}// Thêm sản phẩm vào giỏ hàng\nexport async function addToCart(userId,product){try{if(!userId)throw new Error('Thiếu userId');const{productId,quantity=1,size,name,price,image}=product;const mappedSize=mapSize(size);console.log('Original size:',size,'Mapped size:',mappedSize);console.log('Adding to cart:',{userId,productId,quantity,size:mappedSize,name,price,image});const response=await fetch(`${BASE_URL}/add`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,productId,quantity,size:mappedSize,name,price,image})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'Lỗi khi thêm vào giỏ hàng');}const data=await response.json();console.log('Cart updated:',data);return data;}catch(error){console.error('Error adding to cart:',error.message);throw error;}}// Tăng số lượng sản phẩm\nexport async function increaseQuantity(userId,productId,size){try{if(!userId)throw new Error('Thiếu userId');const mappedSize=mapSize(size);console.log('Increasing quantity:',{userId,productId,size:mappedSize});const response=await fetch(`${BASE_URL}/increase`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,productId,size:mappedSize})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'Lỗi khi tăng số lượng');}return await response.json();}catch(error){console.error('Error increasing quantity:',error.message);throw error;}}// Giảm số lượng sản phẩm\nexport async function decreaseQuantity(userId,productId,size){try{if(!userId)throw new Error('Thiếu userId');const mappedSize=mapSize(size);console.log('Decreasing quantity:',{userId,productId,size:mappedSize});const response=await fetch(`${BASE_URL}/decrease`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,productId,size:mappedSize})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'Lỗi khi giảm số lượng');}return await response.json();}catch(error){console.error('Error decreasing quantity:',error.message);throw error;}}// Xóa sản phẩm khỏi giỏ hàng\nexport async function removeFromCart(userId,productId,size){try{if(!userId)throw new Error('Thiếu userId');const mappedSize=mapSize(size);console.log('Removing from cart:',{userId,productId,size:mappedSize});const response=await fetch(`${BASE_URL}/remove`,{method:'DELETE',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,productId,size:mappedSize})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'Lỗi khi xóa sản phẩm');}return await response.json();}catch(error){console.error('Error removing from cart:',error.message);throw error;}}","map":{"version":3,"names":["BASE_URL","mapSize","size","Error","fetchCart","userId","console","log","response","fetch","ok","errorData","json","message","data","error","addToCart","product","productId","quantity","name","price","image","mappedSize","method","headers","body","JSON","stringify","increaseQuantity","decreaseQuantity","removeFromCart"],"sources":["D:/Năm 4 Kì 2/Phát triển hệ thống thương mại điện tử/ecommerce-app/frontend/src/services/CartService.js"],"sourcesContent":["// src/services/CartService.js\r\n\r\nconst BASE_URL = 'http://localhost:5000/api/carts';\r\n\r\n// Hàm ánh xạ size từ giá trị UI (\"25\", \"5\", \"1\") sang giá trị backend (\"0.25\", \"0.5\", \"1\")\r\nconst mapSize = (size) => {\r\n    switch (size) {\r\n        case \"25\": return \"0.25\";\r\n        case \"5\": return \"0.5\";\r\n        case \"1\": return \"1\";\r\n        case \"0.25\": return \"0.25\";\r\n        case \"0.5\": return \"0.5\";\r\n        case \"1.0\": return \"1\";\r\n        default: throw new Error(`Size không hợp lệ: ${size}. Chỉ hỗ trợ \"25\" (0.25kg), \"5\" (0.5kg), \"1\" (1kg)`);\r\n    }\r\n};\r\n\r\n// Lấy giỏ hàng theo userId\r\nexport async function fetchCart(userId) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        console.log('Fetching cart for userId:', userId);\r\n        const response = await fetch(`${BASE_URL}/${userId}`);\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi lấy giỏ hàng');\r\n        }\r\n        const data = await response.json();\r\n        return data;\r\n    } catch (error) {\r\n        console.error('Error fetching cart:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Thêm sản phẩm vào giỏ hàng\r\nexport async function addToCart(userId, product) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const { productId, quantity = 1, size, name, price, image } = product;\r\n        const mappedSize = mapSize(size);\r\n        console.log('Original size:', size, 'Mapped size:', mappedSize);\r\n        console.log('Adding to cart:', { userId, productId, quantity, size: mappedSize, name, price, image });\r\n\r\n        const response = await fetch(`${BASE_URL}/add`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, quantity, size: mappedSize, name, price, image })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi thêm vào giỏ hàng');\r\n        }\r\n\r\n        const data = await response.json();\r\n        console.log('Cart updated:', data);\r\n        return data;\r\n    } catch (error) {\r\n        console.error('Error adding to cart:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Tăng số lượng sản phẩm\r\nexport async function increaseQuantity(userId, productId, size) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const mappedSize = mapSize(size);\r\n        console.log('Increasing quantity:', { userId, productId, size: mappedSize });\r\n\r\n        const response = await fetch(`${BASE_URL}/increase`, {\r\n            method: 'PUT',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, size: mappedSize })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi tăng số lượng');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Error increasing quantity:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Giảm số lượng sản phẩm\r\nexport async function decreaseQuantity(userId, productId, size) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const mappedSize = mapSize(size);\r\n        console.log('Decreasing quantity:', { userId, productId, size: mappedSize });\r\n\r\n        const response = await fetch(`${BASE_URL}/decrease`, {\r\n            method: 'PUT',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, size: mappedSize })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi giảm số lượng');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Error decreasing quantity:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Xóa sản phẩm khỏi giỏ hàng\r\nexport async function removeFromCart(userId, productId, size) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const mappedSize = mapSize(size);\r\n        console.log('Removing from cart:', { userId, productId, size: mappedSize });\r\n\r\n        const response = await fetch(`${BASE_URL}/remove`, {\r\n            method: 'DELETE',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, size: mappedSize })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi xóa sản phẩm');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Error removing from cart:', error.message);\r\n        throw error;\r\n    }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}