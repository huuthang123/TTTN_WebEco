{"ast":null,"code":"var _jsxFileName = \"D:\\\\N\\u0103m 4 K\\xEC 2\\\\Ph\\xE1t tri\\u1EC3n h\\u1EC7 th\\u1ED1ng th\\u01B0\\u01A1ng m\\u1EA1i \\u0111i\\u1EC7n t\\u1EED\\\\ecommerce-app\\\\frontend\\\\src\\\\components\\\\Payment.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { useCart } from '../context/CartContext'; // Lấy dữ liệu từ giỏ hàng\nimport { useLocation, useNavigate } from 'react-router-dom'; // Để nhận dữ liệu từ \"Mua ngay\"\nimport '../styles/Payment.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Payment() {\n  _s();\n  var _location$state;\n  const {\n    cartItems,\n    total\n  } = useCart(); // Lấy giỏ hàng và tổng tiền từ context\n  const location = useLocation(); // Nhận dữ liệu từ \"Mua ngay\"\n  const navigate = useNavigate();\n\n  // Lấy danh sách sản phẩm đã chọn từ giỏ hàng hoặc từ \"Mua ngay\"\n  const selectedItems = (_location$state = location.state) !== null && _location$state !== void 0 && _location$state.item ? [location.state.item] // Nếu từ \"Mua ngay\", chỉ có 1 sản phẩm\n  : cartItems.filter(item => item.selected); // Nếu từ giỏ hàng, lấy các sản phẩm đã chọn\n\n  // Tính tổng tiền từ danh sách sản phẩm\n  const paymentTotal = selectedItems.reduce((sum, item) => {\n    return sum + item.price * item.quantity;\n  }, 0);\n  useEffect(() => {\n    // Nếu không có sản phẩm nào được chọn hoặc truyền vào, chuyển về trang giỏ hàng\n    if (selectedItems.length === 0) {\n      navigate('/cart');\n    }\n  }, [selectedItems, navigate]);\n  const handlePayment = async () => {\n    // Gửi yêu cầu đến back-end để tạo giao dịch VNPay\n    try {\n      const response = await fetch(`http://localhost:3000/create_payment?amount=${paymentTotal * 100}`);\n      if (response.redirected) {\n        window.location.href = response.url; // Chuyển hướng đến VNPay sandbox\n      }\n    } catch (error) {\n      console.error('Lỗi khi tạo thanh toán:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"payment-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Thanh to\\xE1n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 13\n    }, this), selectedItems.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"payment-items\",\n        children: selectedItems.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"payment-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: item.image,\n            alt: item.name,\n            className: \"payment-item-image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"payment-item-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [item.name, \" (\", item.size, \"kg)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 50,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"\\u0110\\u01A1n gi\\xE1: \", item.price.toLocaleString(), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 51,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"S\\u1ED1 l\\u01B0\\u1EE3ng: \", item.quantity]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 52,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"T\\u1ED5ng: \", (item.price * item.quantity).toLocaleString(), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 53,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 33\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"payment-summary\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"T\\u1ED5ng c\\u1ED9ng (\", selectedItems.length, \" s\\u1EA3n ph\\u1EA9m): \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [paymentTotal.toLocaleString(), \" VND\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 73\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"payment-btn\",\n          onClick: handlePayment,\n          children: \"Thanh to\\xE1n b\\u1EB1ng VNPay\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Kh\\xF4ng c\\xF3 s\\u1EA3n ph\\u1EA9m n\\xE0o \\u0111\\u1EC3 thanh to\\xE1n.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 9\n  }, this);\n}\n_s(Payment, \"m7ELdhekHGG6N0htlmNpAP2U0KE=\", false, function () {\n  return [useCart, useLocation, useNavigate];\n});\n_c = Payment;\nexport default Payment;\nvar _c;\n$RefreshReg$(_c, \"Payment\");","map":{"version":3,"names":["React","useEffect","useCart","useLocation","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","Payment","_s","_location$state","cartItems","total","location","navigate","selectedItems","state","item","filter","selected","paymentTotal","reduce","sum","price","quantity","length","handlePayment","response","fetch","redirected","window","href","url","error","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","index","src","image","alt","name","size","toLocaleString","onClick","_c","$RefreshReg$"],"sources":["D:/Năm 4 Kì 2/Phát triển hệ thống thương mại điện tử/ecommerce-app/frontend/src/components/Payment.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useCart } from '../context/CartContext'; // Lấy dữ liệu từ giỏ hàng\r\nimport { useLocation, useNavigate } from 'react-router-dom'; // Để nhận dữ liệu từ \"Mua ngay\"\r\nimport '../styles/Payment.css';\r\n\r\nfunction Payment() {\r\n    const { cartItems, total } = useCart(); // Lấy giỏ hàng và tổng tiền từ context\r\n    const location = useLocation(); // Nhận dữ liệu từ \"Mua ngay\"\r\n    const navigate = useNavigate();\r\n    \r\n    // Lấy danh sách sản phẩm đã chọn từ giỏ hàng hoặc từ \"Mua ngay\"\r\n    const selectedItems = location.state?.item \r\n        ? [location.state.item] // Nếu từ \"Mua ngay\", chỉ có 1 sản phẩm\r\n        : cartItems.filter(item => item.selected); // Nếu từ giỏ hàng, lấy các sản phẩm đã chọn\r\n\r\n    // Tính tổng tiền từ danh sách sản phẩm\r\n    const paymentTotal = selectedItems.reduce((sum, item) => {\r\n        return sum + (item.price * item.quantity);\r\n    }, 0);\r\n\r\n    useEffect(() => {\r\n        // Nếu không có sản phẩm nào được chọn hoặc truyền vào, chuyển về trang giỏ hàng\r\n        if (selectedItems.length === 0) {\r\n            navigate('/cart');\r\n        }\r\n    }, [selectedItems, navigate]);\r\n\r\n    const handlePayment = async () => {\r\n        // Gửi yêu cầu đến back-end để tạo giao dịch VNPay\r\n        try {\r\n            const response = await fetch(`http://localhost:3000/create_payment?amount=${paymentTotal * 100}`);\r\n            if (response.redirected) {\r\n                window.location.href = response.url; // Chuyển hướng đến VNPay sandbox\r\n            }\r\n        } catch (error) {\r\n            console.error('Lỗi khi tạo thanh toán:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"payment-container\">\r\n            <h2>Thanh toán</h2>\r\n            {selectedItems.length > 0 ? (\r\n                <>\r\n                    <div className=\"payment-items\">\r\n                        {selectedItems.map((item, index) => (\r\n                            <div key={index} className=\"payment-item\">\r\n                                <img src={item.image} alt={item.name} className=\"payment-item-image\" />\r\n                                <div className=\"payment-item-details\">\r\n                                    <p>{item.name} ({item.size}kg)</p>\r\n                                    <p>Đơn giá: {item.price.toLocaleString()} VND</p>\r\n                                    <p>Số lượng: {item.quantity}</p>\r\n                                    <p>Tổng: {(item.price * item.quantity).toLocaleString()} VND</p>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"payment-summary\">\r\n                        <p>Tổng cộng ({selectedItems.length} sản phẩm): <strong>{paymentTotal.toLocaleString()} VND</strong></p>\r\n                        <button className=\"payment-btn\" onClick={handlePayment}>\r\n                            Thanh toán bằng VNPay\r\n                        </button>\r\n                    </div>\r\n                </>\r\n            ) : (\r\n                <p>Không có sản phẩm nào để thanh toán.</p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Payment;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}