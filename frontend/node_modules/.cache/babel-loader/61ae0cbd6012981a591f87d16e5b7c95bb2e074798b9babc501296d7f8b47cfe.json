{"ast":null,"code":"// src/components/CartSidebar.jsx\nimport React,{useEffect}from'react';import'../styles/cartsidebar.css';import{useCart}from'../context/CartContext';import{useAuth}from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function CartSidebar(){const{cartItems,removeFromCart,isOpen,toggleCart,total,totalItems,increaseQuantity,decreaseQuantity,toggleItemSelection,selectAll,fetchCartFromServer,loadCartFromLocalStorage}=useCart();const{user}=useAuth();useEffect(()=>{if(user&&user._id){fetchCartFromServer(user._id);}else{loadCartFromLocalStorage();}},[user,fetchCartFromServer,loadCartFromLocalStorage]);const hasSelectedItems=cartItems.some(item=>item.selected);const allSelected=cartItems.length>0&&cartItems.every(item=>item.selected);const handleToggleAll=()=>{// G·ªçi selectAll v·ªõi true n·∫øu ch∆∞a ch·ªçn h·∫øt, false n·∫øu ƒë√£ ch·ªçn h·∫øt\nselectAll(!allSelected);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-toggle-btn\",onClick:toggleCart,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shopping-cart\"}),/*#__PURE__*/_jsx(\"span\",{className:\"cart-count-badge\",children:totalItems})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"cart-sidebar\",className:isOpen?'open':'closed',children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Gi\\u1ECF h\\xE0ng \\uD83D\\uDED2\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:toggleCart,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-actions\",children:[cartItems.length>0&&/*#__PURE__*/_jsx(\"button\",{className:`toggle-all-btn ${allSelected?'checked':''}`,onClick:handleToggleAll,children:allSelected&&/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})}),/*#__PURE__*/_jsxs(\"p\",{id:\"cart-count\",children:[\"T\\u1ED5ng s\\u1ED1 l\\u01B0\\u1EE3ng: \",totalItems]})]}),/*#__PURE__*/_jsx(\"ul\",{id:\"cart-items\",children:cartItems.map((item,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:item.selected||false,onChange:()=>toggleItemSelection(item.productId,item.size)// S·ª≠a th√†nh productId v√† size\n,className:\"cart-item-checkbox\"}),/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"cart-item-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item-details\",children:[/*#__PURE__*/_jsx(\"span\",{children:typeof item.name==='string'&&typeof item.size==='string'?`${item.name} (${item.size}kg)`:\"T√™n s·∫£n ph·∫©m kh√¥ng h·ª£p l·ªá\"}),/*#__PURE__*/_jsx(\"span\",{children:typeof item.price==='number'?`${item.price.toLocaleString()} VND`:\"Ch∆∞a c√≥ gi√°\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"quantity-controls\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>decreaseQuantity(item.productId,item.size),children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{children:typeof item.quantity==='number'?item.quantity:1}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>increaseQuantity(item.productId,item.size),children:\"+\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFromCart(item.productId,item.size),children:\"X\\xF3a\"})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-footer\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"T\\u1ED5ng ti\\u1EC1n (\\u0111\\xE3 ch\\u1ECDn):\",/*#__PURE__*/_jsx(\"span\",{id:\"cart-total\",children:typeof total==='number'?`${total.toLocaleString()} VND`:\"Kh√¥ng x√°c ƒë·ªãnh\"})]}),/*#__PURE__*/_jsx(\"button\",{id:\"checkout-btn\",children:\"Thanh to\\xE1n\"})]})]})]});}export default CartSidebar;","map":{"version":3,"names":["React","useEffect","useCart","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CartSidebar","cartItems","removeFromCart","isOpen","toggleCart","total","totalItems","increaseQuantity","decreaseQuantity","toggleItemSelection","selectAll","fetchCartFromServer","loadCartFromLocalStorage","user","_id","hasSelectedItems","some","item","selected","allSelected","length","every","handleToggleAll","children","className","onClick","id","map","index","type","checked","onChange","productId","size","src","image","alt","name","price","toLocaleString","quantity"],"sources":["D:/NƒÉm 4 K√¨ 2/Ph√°t tri·ªÉn h·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠/ecommerce-app/frontend/src/components/CartSidebar.jsx"],"sourcesContent":["// src/components/CartSidebar.jsx\r\nimport React, { useEffect } from 'react';\r\nimport '../styles/cartsidebar.css';\r\nimport { useCart } from '../context/CartContext';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nfunction CartSidebar() {\r\n    const {\r\n        cartItems,\r\n        removeFromCart,\r\n        isOpen,\r\n        toggleCart,\r\n        total,\r\n        totalItems,\r\n        increaseQuantity,\r\n        decreaseQuantity,\r\n        toggleItemSelection,\r\n        selectAll,\r\n        fetchCartFromServer,\r\n        loadCartFromLocalStorage\r\n    } = useCart();\r\n\r\n    const { user } = useAuth();\r\n\r\n    useEffect(() => {\r\n        if (user && user._id) {\r\n            fetchCartFromServer(user._id);\r\n        } else {\r\n            loadCartFromLocalStorage();\r\n        }\r\n    }, [user, fetchCartFromServer, loadCartFromLocalStorage]);\r\n\r\n    const hasSelectedItems = cartItems.some(item => item.selected);\r\n    const allSelected = cartItems.length > 0 && cartItems.every(item => item.selected);\r\n\r\n    const handleToggleAll = () => {\r\n        // G·ªçi selectAll v·ªõi true n·∫øu ch∆∞a ch·ªçn h·∫øt, false n·∫øu ƒë√£ ch·ªçn h·∫øt\r\n        selectAll(!allSelected);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"cart-toggle-btn\" onClick={toggleCart}>\r\n                <i className=\"fas fa-shopping-cart\"></i>\r\n                <span className=\"cart-count-badge\">{totalItems}</span>\r\n            </div>\r\n\r\n            <div id=\"cart-sidebar\" className={isOpen ? 'open' : 'closed'}>\r\n                <div className=\"cart-header\">\r\n                    <h2>Gi·ªè h√†ng üõí</h2>\r\n                    <button className=\"close-btn\" onClick={toggleCart}>\r\n                        <i className=\"fas fa-times\"></i>\r\n                    </button>\r\n                </div>\r\n                <div className=\"cart-actions\">\r\n                    {cartItems.length > 0 && (\r\n                        <button\r\n                            className={`toggle-all-btn ${allSelected ? 'checked' : ''}`}\r\n                            onClick={handleToggleAll}\r\n                        >\r\n                            {allSelected && <i className=\"fas fa-check\"></i>}\r\n                        </button>\r\n                    )}\r\n                    <p id=\"cart-count\">T·ªïng s·ªë l∆∞·ª£ng: {totalItems}</p>\r\n                </div>\r\n                <ul id=\"cart-items\">\r\n                    {cartItems.map((item, index) => (\r\n                        <li key={index} className=\"cart-item\">\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={item.selected || false}\r\n                                onChange={() => toggleItemSelection(item.productId, item.size)} // S·ª≠a th√†nh productId v√† size\r\n                                className=\"cart-item-checkbox\"\r\n                            />\r\n                            <img src={item.image} alt={item.name} className=\"cart-item-image\" />\r\n                            <div className=\"cart-item-details\">\r\n                                <span>\r\n                                    {typeof item.name === 'string' && typeof item.size === 'string' \r\n                                        ? `${item.name} (${item.size}kg)`\r\n                                        : \"T√™n s·∫£n ph·∫©m kh√¥ng h·ª£p l·ªá\"}\r\n                                </span>\r\n                                <span>\r\n                                    {typeof item.price === 'number' \r\n                                        ? `${item.price.toLocaleString()} VND` \r\n                                        : \"Ch∆∞a c√≥ gi√°\"}\r\n                                </span>\r\n                                <div className=\"quantity-controls\">\r\n                                    <button onClick={() => decreaseQuantity(item.productId, item.size)}>-</button>\r\n                                    <span>{typeof item.quantity === 'number' ? item.quantity : 1}</span>\r\n                                    <button onClick={() => increaseQuantity(item.productId, item.size)}>+</button>\r\n                                </div>\r\n                            </div>\r\n                            <button onClick={() => removeFromCart(item.productId, item.size)}>X√≥a</button>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n                <div className=\"cart-footer\">\r\n                    <p>\r\n                        T·ªïng ti·ªÅn (ƒë√£ ch·ªçn): \r\n                        <span id=\"cart-total\">\r\n                            {typeof total === 'number' ? `${total.toLocaleString()} VND` : \"Kh√¥ng x√°c ƒë·ªãnh\"}\r\n                        </span>\r\n                    </p>\r\n                    <button id=\"checkout-btn\">\r\n                        Thanh to√°n\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default CartSidebar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}