{"ast":null,"code":"var _jsxFileName = \"D:\\\\N\\u0103m 4 K\\xEC 2\\\\Ph\\xE1t tri\\u1EC3n h\\u1EC7 th\\u1ED1ng th\\u01B0\\u01A1ng m\\u1EA1i \\u0111i\\u1EC7n t\\u1EED\\\\ecommerce-app\\\\frontend\\\\src\\\\components\\\\ProductDetail.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useParams } from 'react-router-dom';\nimport Header from './Header';\nimport ProductItem from './ProductItem';\nimport RelatedItems from './RelatedItems';\nimport Footer from './Footer';\nimport { useCart } from '../context/CartContext';\nimport { useAuth } from '../context/AuthContext';\nimport '../styles/ProductDetail.css';\nimport CartSidebar from './CartSidebar';\nimport ShippingAddressForm from './ShippingAddressForm';\nimport AddressService from '../services/AddressService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProductDetail = () => {\n  _s();\n  const {\n    category,\n    id\n  } = useParams();\n  const {\n    addToCart\n  } = useCart();\n  const {\n    user\n  } = useAuth();\n  const [product, setProduct] = useState(null);\n  const [relatedProducts, setRelatedProducts] = useState([]);\n  const [selectedAddress, setSelectedAddress] = useState(null);\n  const [savedAddresses, setSavedAddresses] = useState([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [isAddressTableOpen, setIsAddressTableOpen] = useState(false);\n  const [editingAddress, setEditingAddress] = useState(null);\n  const [error, setError] = useState(null);\n  const [isFetchingAddresses, setIsFetchingAddresses] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [successMessage, setSuccessMessage] = useState(null);\n  const fetchProduct = useCallback(async () => {\n    try {\n      const response = await fetch(`http://localhost:5000/api/products/${id}`);\n      if (!response.ok) {\n        throw new Error(`Không tìm thấy sản phẩm: ${response.status} ${response.statusText}`);\n      }\n      const data = await response.json();\n      console.log('Product data from API:', data);\n      setProduct(data);\n    } catch (err) {\n      console.error('Lỗi tải sản phẩm:', err);\n      setError('Không thể tải thông tin sản phẩm');\n    } finally {\n      setLoading(false);\n    }\n  }, [id]);\n  const fetchRelatedProducts = useCallback(async () => {\n    try {\n      const response = await fetch(`http://localhost:5000/api/products/list`);\n      if (!response.ok) {\n        throw new Error(`Không tìm thấy sản phẩm liên quan: ${response.status} ${response.statusText}`);\n      }\n      const data = await response.json();\n      console.log('Related products from API:', data);\n      if (Array.isArray(data)) {\n        setRelatedProducts(data.filter(p => p._id !== id && p.category === category));\n      } else {\n        console.error('Dữ liệu sản phẩm liên quan không phải mảng:', data);\n        setRelatedProducts([]);\n      }\n    } catch (err) {\n      console.error('Lỗi tải sản phẩm liên quan:', err);\n      setRelatedProducts([]);\n    }\n  }, [category, id]);\n  const fetchAddresses = useCallback(async () => {\n    if (!(user !== null && user !== void 0 && user.token)) {\n      setError('Vui lòng đăng nhập để quản lý địa chỉ');\n      return;\n    }\n    if (isFetchingAddresses) return;\n    setIsFetchingAddresses(true);\n    try {\n      console.log('Token gửi đi trong fetchAddresses:', user.token);\n      const addresses = await AddressService.getAddresses(user.token);\n      setSavedAddresses(addresses);\n      // Chỉ chọn địa chỉ mặc định nếu chưa có selectedAddress\n      if (addresses.length > 0 && !selectedAddress) {\n        setSelectedAddress({\n          fullName: addresses[0].fullName,\n          address: `${addresses[0].detail}, ${addresses[0].ward}, ${addresses[0].district}, ${addresses[0].province}`,\n          phone: addresses[0].phone\n        });\n      } else if (selectedAddress) {\n        // Kiểm tra xem selectedAddress có còn trong danh sách không\n        const currentAddress = addresses.find(addr => addr.fullName === selectedAddress.fullName && addr.phone === selectedAddress.phone && `${addr.detail}, ${addr.ward}, ${addr.district}, ${addr.province}` === selectedAddress.address);\n        if (!currentAddress) {\n          // Nếu địa chỉ hiện tại không còn trong danh sách, chọn địa chỉ đầu tiên\n          setSelectedAddress({\n            fullName: addresses[0].fullName,\n            address: `${addresses[0].detail}, ${addresses[0].ward}, ${addresses[0].district}, ${addresses[0].province}`,\n            phone: addresses[0].phone\n          });\n        }\n      }\n      setError(null);\n    } catch (error) {\n      console.error('Lỗi khi lấy danh sách địa chỉ:', error.message);\n      setError(error.message || 'Không thể tải danh sách địa chỉ');\n      setSavedAddresses([]);\n      setSelectedAddress(null);\n    } finally {\n      setIsFetchingAddresses(false);\n    }\n  }, [user, selectedAddress]);\n  useEffect(() => {\n    fetchProduct();\n    fetchRelatedProducts();\n  }, [fetchProduct, fetchRelatedProducts]);\n  useEffect(() => {\n    fetchAddresses();\n  }, [fetchAddresses]);\n  const handleAddressSelect = async address => {\n    setSelectedAddress({\n      fullName: address.fullName,\n      address: address.address || `${address.detail}, ${address.ward}, ${address.district}, ${address.province}`,\n      phone: address.phone\n    });\n    setSuccessMessage('Địa chỉ đã được chọn thành công');\n    setTimeout(() => setSuccessMessage(null), 3000);\n  };\n  const handleAddressAdded = async newAddress => {\n    setSuccessMessage('Địa chỉ mới đã được thêm thành công');\n    setTimeout(() => setSuccessMessage(null), 3000);\n    await fetchAddresses();\n  };\n  const handleSelectAddress = address => {\n    setSelectedAddress({\n      fullName: address.fullName,\n      address: `${address.detail}, ${address.ward}, ${address.district}, ${address.province}`,\n      phone: address.phone\n    });\n    setSuccessMessage('Địa chỉ đã được chọn thành công');\n    setTimeout(() => setSuccessMessage(null), 3000);\n    setIsAddressTableOpen(false);\n  };\n  const handleEditAddress = address => {\n    setEditingAddress(address);\n    setIsModalOpen(true);\n  };\n  const handleDeleteAddress = async addressId => {\n    if (!(user !== null && user !== void 0 && user.token)) return;\n    try {\n      var _savedAddresses$find;\n      await AddressService.deleteAddress(addressId, user.token);\n      const updatedAddresses = savedAddresses.filter(addr => addr._id !== addressId);\n      setSavedAddresses(updatedAddresses);\n      if (selectedAddress && addressId === ((_savedAddresses$find = savedAddresses.find(addr => addr.fullName === selectedAddress.fullName && addr.phone === selectedAddress.phone && `${addr.detail}, ${addr.ward}, ${addr.district}, ${addr.province}` === selectedAddress.address)) === null || _savedAddresses$find === void 0 ? void 0 : _savedAddresses$find._id)) {\n        if (updatedAddresses.length > 0) {\n          setSelectedAddress({\n            fullName: updatedAddresses[0].fullName,\n            address: `${updatedAddresses[0].detail}, ${updatedAddresses[0].ward}, ${updatedAddresses[0].district}, ${updatedAddresses[0].province}`,\n            phone: updatedAddresses[0].phone\n          });\n        } else {\n          setSelectedAddress(null);\n        }\n      }\n      setSuccessMessage('Địa chỉ đã được xóa thành công');\n      setTimeout(() => setSuccessMessage(null), 3000);\n    } catch (error) {\n      console.error('Lỗi khi xóa địa chỉ:', error);\n      setError(error.message || 'Không thể xóa địa chỉ');\n    }\n  };\n  const openModal = () => {\n    setEditingAddress(null);\n    setIsModalOpen(true);\n    setSuccessMessage(null);\n  };\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setEditingAddress(null);\n    fetchAddresses();\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\u0110ang t\\u1EA3i s\\u1EA3n ph\\u1EA9m...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 12\n    }, this);\n  }\n  if (!product) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Kh\\xF4ng t\\xECm th\\u1EA5y s\\u1EA3n ph\\u1EA9m.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"product-detail\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-content\",\n      children: [/*#__PURE__*/_jsxDEV(ProductItem, {\n        product: product,\n        addToCart: addToCart,\n        selectedAddress: selectedAddress\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"address-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u0110\\u1ECBa ch\\u1EC9 giao h\\xE0ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 21\n        }, this), successMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"success-message\",\n          children: successMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 30\n        }, this), selectedAddress ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"selected-address-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 18\n            }, this), \" \", selectedAddress.phone]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0110\\u1ECBa ch\\u1EC9:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 18\n            }, this), \" \", selectedAddress.address]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Ch\\u01B0a c\\xF3 \\u0111\\u1ECBa ch\\u1EC9 giao h\\xE0ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setIsAddressTableOpen(!isAddressTableOpen),\n          className: \"change-address-btn\",\n          children: selectedAddress ? 'Thay đổi địa chỉ' : 'Chọn địa chỉ giao hàng'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), isAddressTableOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"address-table-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"address-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"H\\u1ECD v\\xE0 t\\xEAn\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"\\u0110\\u1ECBa ch\\u1EC9\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"H\\xE0nh \\u0111\\u1ED9ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: savedAddresses.length > 0 ? savedAddresses.map(address => /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: address.fullName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: `${address.detail}, ${address.ward}, ${address.district}, ${address.province}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: address.phone\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => handleSelectAddress(address),\n                    className: \"select-btn\",\n                    children: \"Ch\\u1ECDn\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => handleEditAddress(address),\n                    className: \"edit-btn\",\n                    children: \"S\\u1EEDa\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 256,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => handleDeleteAddress(address._id),\n                    className: \"delete-btn\",\n                    children: \"X\\xF3a\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 25\n                }, this)]\n              }, address._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 23\n              }, this)) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: /*#__PURE__*/_jsxDEV(\"td\", {\n                  colSpan: \"4\",\n                  children: \"Ch\\u01B0a c\\xF3 \\u0111\\u1ECBa ch\\u1EC9 n\\xE0o\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 273,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: openModal,\n            className: \"add-address-btn\",\n            children: \"Th\\xEAm \\u0111\\u1ECBa ch\\u1EC9 m\\u1EDBi\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), isModalOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"address-form-overlay\",\n        children: /*#__PURE__*/_jsxDEV(ShippingAddressForm, {\n          onAddressSelect: handleAddressSelect,\n          onAddressAdded: handleAddressAdded,\n          onClose: closeModal,\n          initialData: editingAddress,\n          isAddingNew: !editingAddress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(RelatedItems, {\n        relatedProducts: relatedProducts,\n        currentProductId: id,\n        addToCart: addToCart,\n        selectedAddress: selectedAddress\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CartSidebar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 5\n  }, this);\n};\n_s(ProductDetail, \"vxinZCqNfo7yCQYrVhS3VDWmm5k=\", false, function () {\n  return [useParams, useCart, useAuth];\n});\n_c = ProductDetail;\nexport default ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useParams","Header","ProductItem","RelatedItems","Footer","useCart","useAuth","CartSidebar","ShippingAddressForm","AddressService","jsxDEV","_jsxDEV","ProductDetail","_s","category","id","addToCart","user","product","setProduct","relatedProducts","setRelatedProducts","selectedAddress","setSelectedAddress","savedAddresses","setSavedAddresses","isModalOpen","setIsModalOpen","isAddressTableOpen","setIsAddressTableOpen","editingAddress","setEditingAddress","error","setError","isFetchingAddresses","setIsFetchingAddresses","loading","setLoading","successMessage","setSuccessMessage","fetchProduct","response","fetch","ok","Error","status","statusText","data","json","console","log","err","fetchRelatedProducts","Array","isArray","filter","p","_id","fetchAddresses","token","addresses","getAddresses","length","fullName","address","detail","ward","district","province","phone","currentAddress","find","addr","message","handleAddressSelect","setTimeout","handleAddressAdded","newAddress","handleSelectAddress","handleEditAddress","handleDeleteAddress","addressId","_savedAddresses$find","deleteAddress","updatedAddresses","openModal","closeModal","children","fileName","_jsxFileName","lineNumber","columnNumber","className","onClick","map","colSpan","onAddressSelect","onAddressAdded","onClose","initialData","isAddingNew","currentProductId","_c","$RefreshReg$"],"sources":["D:/Năm 4 Kì 2/Phát triển hệ thống thương mại điện tử/ecommerce-app/frontend/src/components/ProductDetail.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport Header from './Header';\r\nimport ProductItem from './ProductItem';\r\nimport RelatedItems from './RelatedItems';\r\nimport Footer from './Footer';\r\nimport { useCart } from '../context/CartContext';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport '../styles/ProductDetail.css';\r\nimport CartSidebar from './CartSidebar';\r\nimport ShippingAddressForm from './ShippingAddressForm';\r\nimport AddressService from '../services/AddressService';\r\n\r\nconst ProductDetail = () => {\r\n  const { category, id } = useParams();\r\n  const { addToCart } = useCart();\r\n  const { user } = useAuth();\r\n  const [product, setProduct] = useState(null);\r\n  const [relatedProducts, setRelatedProducts] = useState([]);\r\n  const [selectedAddress, setSelectedAddress] = useState(null);\r\n  const [savedAddresses, setSavedAddresses] = useState([]);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [isAddressTableOpen, setIsAddressTableOpen] = useState(false);\r\n  const [editingAddress, setEditingAddress] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [isFetchingAddresses, setIsFetchingAddresses] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [successMessage, setSuccessMessage] = useState(null);\r\n\r\n  const fetchProduct = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(`http://localhost:5000/api/products/${id}`);\r\n      if (!response.ok) {\r\n        throw new Error(`Không tìm thấy sản phẩm: ${response.status} ${response.statusText}`);\r\n      }\r\n      const data = await response.json();\r\n      console.log('Product data from API:', data);\r\n      setProduct(data);\r\n    } catch (err) {\r\n      console.error('Lỗi tải sản phẩm:', err);\r\n      setError('Không thể tải thông tin sản phẩm');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [id]);\r\n\r\n  const fetchRelatedProducts = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(`http://localhost:5000/api/products/list`);\r\n      if (!response.ok) {\r\n        throw new Error(`Không tìm thấy sản phẩm liên quan: ${response.status} ${response.statusText}`);\r\n      }\r\n      const data = await response.json();\r\n      console.log('Related products from API:', data);\r\n      if (Array.isArray(data)) {\r\n        setRelatedProducts(data.filter((p) => p._id !== id && p.category === category));\r\n      } else {\r\n        console.error('Dữ liệu sản phẩm liên quan không phải mảng:', data);\r\n        setRelatedProducts([]);\r\n      }\r\n    } catch (err) {\r\n      console.error('Lỗi tải sản phẩm liên quan:', err);\r\n      setRelatedProducts([]);\r\n    }\r\n  }, [category, id]);\r\n\r\n  const fetchAddresses = useCallback(async () => {\r\n    if (!user?.token) {\r\n      setError('Vui lòng đăng nhập để quản lý địa chỉ');\r\n      return;\r\n    }\r\n    if (isFetchingAddresses) return;\r\n    setIsFetchingAddresses(true);\r\n    try {\r\n      console.log('Token gửi đi trong fetchAddresses:', user.token);\r\n      const addresses = await AddressService.getAddresses(user.token);\r\n      setSavedAddresses(addresses);\r\n      // Chỉ chọn địa chỉ mặc định nếu chưa có selectedAddress\r\n      if (addresses.length > 0 && !selectedAddress) {\r\n        setSelectedAddress({\r\n          fullName: addresses[0].fullName,\r\n          address: `${addresses[0].detail}, ${addresses[0].ward}, ${addresses[0].district}, ${addresses[0].province}`,\r\n          phone: addresses[0].phone,\r\n        });\r\n      } else if (selectedAddress) {\r\n        // Kiểm tra xem selectedAddress có còn trong danh sách không\r\n        const currentAddress = addresses.find(\r\n          (addr) =>\r\n            addr.fullName === selectedAddress.fullName &&\r\n            addr.phone === selectedAddress.phone &&\r\n            `${addr.detail}, ${addr.ward}, ${addr.district}, ${addr.province}` === selectedAddress.address\r\n        );\r\n        if (!currentAddress) {\r\n          // Nếu địa chỉ hiện tại không còn trong danh sách, chọn địa chỉ đầu tiên\r\n          setSelectedAddress({\r\n            fullName: addresses[0].fullName,\r\n            address: `${addresses[0].detail}, ${addresses[0].ward}, ${addresses[0].district}, ${addresses[0].province}`,\r\n            phone: addresses[0].phone,\r\n          });\r\n        }\r\n      }\r\n      setError(null);\r\n    } catch (error) {\r\n      console.error('Lỗi khi lấy danh sách địa chỉ:', error.message);\r\n      setError(error.message || 'Không thể tải danh sách địa chỉ');\r\n      setSavedAddresses([]);\r\n      setSelectedAddress(null);\r\n    } finally {\r\n      setIsFetchingAddresses(false);\r\n    }\r\n  }, [user, selectedAddress]);\r\n\r\n  useEffect(() => {\r\n    fetchProduct();\r\n    fetchRelatedProducts();\r\n  }, [fetchProduct, fetchRelatedProducts]);\r\n\r\n  useEffect(() => {\r\n    fetchAddresses();\r\n  }, [fetchAddresses]);\r\n\r\n  const handleAddressSelect = async (address) => {\r\n    setSelectedAddress({\r\n      fullName: address.fullName,\r\n      address: address.address || `${address.detail}, ${address.ward}, ${address.district}, ${address.province}`,\r\n      phone: address.phone,\r\n    });\r\n    setSuccessMessage('Địa chỉ đã được chọn thành công');\r\n    setTimeout(() => setSuccessMessage(null), 3000);\r\n  };\r\n\r\n  const handleAddressAdded = async (newAddress) => {\r\n    setSuccessMessage('Địa chỉ mới đã được thêm thành công');\r\n    setTimeout(() => setSuccessMessage(null), 3000);\r\n    await fetchAddresses();\r\n  };\r\n\r\n  const handleSelectAddress = (address) => {\r\n    setSelectedAddress({\r\n      fullName: address.fullName,\r\n      address: `${address.detail}, ${address.ward}, ${address.district}, ${address.province}`,\r\n      phone: address.phone,\r\n    });\r\n    setSuccessMessage('Địa chỉ đã được chọn thành công');\r\n    setTimeout(() => setSuccessMessage(null), 3000);\r\n    setIsAddressTableOpen(false);\r\n  };\r\n\r\n  const handleEditAddress = (address) => {\r\n    setEditingAddress(address);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleDeleteAddress = async (addressId) => {\r\n    if (!user?.token) return;\r\n    try {\r\n      await AddressService.deleteAddress(addressId, user.token);\r\n      const updatedAddresses = savedAddresses.filter((addr) => addr._id !== addressId);\r\n      setSavedAddresses(updatedAddresses);\r\n      if (selectedAddress && addressId === savedAddresses.find(addr => \r\n        addr.fullName === selectedAddress.fullName &&\r\n        addr.phone === selectedAddress.phone &&\r\n        `${addr.detail}, ${addr.ward}, ${addr.district}, ${addr.province}` === selectedAddress.address\r\n      )?._id) {\r\n        if (updatedAddresses.length > 0) {\r\n          setSelectedAddress({\r\n            fullName: updatedAddresses[0].fullName,\r\n            address: `${updatedAddresses[0].detail}, ${updatedAddresses[0].ward}, ${updatedAddresses[0].district}, ${updatedAddresses[0].province}`,\r\n            phone: updatedAddresses[0].phone,\r\n          });\r\n        } else {\r\n          setSelectedAddress(null);\r\n        }\r\n      }\r\n      setSuccessMessage('Địa chỉ đã được xóa thành công');\r\n      setTimeout(() => setSuccessMessage(null), 3000);\r\n    } catch (error) {\r\n      console.error('Lỗi khi xóa địa chỉ:', error);\r\n      setError(error.message || 'Không thể xóa địa chỉ');\r\n    }\r\n  };\r\n\r\n  const openModal = () => {\r\n    setEditingAddress(null);\r\n    setIsModalOpen(true);\r\n    setSuccessMessage(null);\r\n  };\r\n\r\n  const closeModal = () => {\r\n    setIsModalOpen(false);\r\n    setEditingAddress(null);\r\n    fetchAddresses();\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Đang tải sản phẩm...</div>;\r\n  }\r\n\r\n  if (!product) {\r\n    return <div>Không tìm thấy sản phẩm.</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"product-detail\">\r\n      <Header />\r\n      <div className=\"product-content\">\r\n        <ProductItem\r\n          product={product}\r\n          addToCart={addToCart}\r\n          selectedAddress={selectedAddress}\r\n        />\r\n        <div className=\"address-section\">\r\n          <h3>Địa chỉ giao hàng</h3>\r\n          {error && <p className=\"error-message\">{error}</p>}\r\n          {successMessage && <p className=\"success-message\">{successMessage}</p>}\r\n          {selectedAddress ? (\r\n            <div className=\"selected-address-section\">\r\n              <p><strong>Số điện thoại:</strong> {selectedAddress.phone}</p>\r\n              <p><strong>Địa chỉ:</strong> {selectedAddress.address}</p>\r\n            </div>\r\n          ) : (\r\n            <p>Chưa có địa chỉ giao hàng</p>\r\n          )}\r\n          <button\r\n            onClick={() => setIsAddressTableOpen(!isAddressTableOpen)}\r\n            className=\"change-address-btn\"\r\n          >\r\n            {selectedAddress ? 'Thay đổi địa chỉ' : 'Chọn địa chỉ giao hàng'}\r\n          </button>\r\n\r\n          {isAddressTableOpen && (\r\n            <div className=\"address-table-container\">\r\n              <table className=\"address-table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Họ và tên</th>\r\n                    <th>Địa chỉ</th>\r\n                    <th>Số điện thoại</th>\r\n                    <th>Hành động</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {savedAddresses.length > 0 ? (\r\n                    savedAddresses.map((address) => (\r\n                      <tr key={address._id}>\r\n                        <td>{address.fullName}</td>\r\n                        <td>{`${address.detail}, ${address.ward}, ${address.district}, ${address.province}`}</td>\r\n                        <td>{address.phone}</td>\r\n                        <td>\r\n                          <button\r\n                            onClick={() => handleSelectAddress(address)}\r\n                            className=\"select-btn\"\r\n                          >\r\n                            Chọn\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleEditAddress(address)}\r\n                            className=\"edit-btn\"\r\n                          >\r\n                            Sửa\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleDeleteAddress(address._id)}\r\n                            className=\"delete-btn\"\r\n                          >\r\n                            Xóa\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))\r\n                  ) : (\r\n                    <tr>\r\n                      <td colSpan=\"4\">Chưa có địa chỉ nào</td>\r\n                    </tr>\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n              <button onClick={openModal} className=\"add-address-btn\">\r\n                Thêm địa chỉ mới\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {isModalOpen && (\r\n          <div className=\"address-form-overlay\">\r\n            <ShippingAddressForm\r\n              onAddressSelect={handleAddressSelect}\r\n              onAddressAdded={handleAddressAdded}\r\n              onClose={closeModal}\r\n              initialData={editingAddress}\r\n              isAddingNew={!editingAddress}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        <RelatedItems\r\n          relatedProducts={relatedProducts}\r\n          currentProductId={id}\r\n          addToCart={addToCart}\r\n          selectedAddress={selectedAddress}\r\n        />\r\n      </div>\r\n      <Footer />\r\n      <CartSidebar />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductDetail;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}