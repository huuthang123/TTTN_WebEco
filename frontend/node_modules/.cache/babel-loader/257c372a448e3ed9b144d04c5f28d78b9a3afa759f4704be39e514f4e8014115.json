{"ast":null,"code":"// src/services/CartService.js\n\nconst BASE_URL = 'http://localhost:5000/api/carts';\n\n// Hàm ánh xạ size từ giá trị UI (\"25\", \"5\", \"1\") sang giá trị backend (\"0.25\", \"0.5\", \"1\")\nconst mapSize = size => {\n  switch (size) {\n    case \"25\":\n      return \"0.25\";\n    case \"5\":\n      return \"0.5\";\n    case \"1\":\n      return \"1\";\n    case \"0.25\":\n      return \"0.25\";\n    case \"0.5\":\n      return \"0.5\";\n    case \"1.0\":\n      return \"1\";\n    default:\n      throw new Error(`Size không hợp lệ: ${size}. Chỉ hỗ trợ \"25\" (0.25kg), \"5\" (0.5kg), \"1\" (1kg)`);\n  }\n};\n\n// Lấy giỏ hàng theo userId\nexport async function fetchCart(userId) {\n  try {\n    if (!userId) throw new Error('Thiếu userId');\n    console.log('Fetching cart for userId:', userId);\n    const response = await fetch(`${BASE_URL}/${userId}`);\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Lỗi khi lấy giỏ hàng');\n    }\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Error fetching cart:', error.message);\n    throw error;\n  }\n}\n\n// Thêm sản phẩm vào giỏ hàng\nexport async function addToCart(userId, product) {\n  try {\n    if (!userId) throw new Error('Thiếu userId');\n    const {\n      productId,\n      quantity = 1,\n      size,\n      name,\n      price,\n      image\n    } = product;\n    const mappedSize = mapSize(size);\n    console.log('Original size:', size, 'Mapped size:', mappedSize);\n    console.log('Adding to cart:', {\n      userId,\n      productId,\n      quantity,\n      size: mappedSize,\n      name,\n      price,\n      image\n    });\n    const response = await fetch(`${BASE_URL}/add`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        userId,\n        productId,\n        quantity,\n        size: mappedSize,\n        name,\n        price,\n        image\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Lỗi khi thêm vào giỏ hàng');\n    }\n    const data = await response.json();\n    console.log('Cart updated:', data);\n    return data;\n  } catch (error) {\n    console.error('Error adding to cart:', error.message);\n    throw error;\n  }\n}\n\n// Tăng số lượng sản phẩm\nexport async function increaseQuantity(userId, productId, size) {\n  try {\n    if (!userId) throw new Error('Thiếu userId');\n    const mappedSize = mapSize(size);\n    console.log('Increasing quantity:', {\n      userId,\n      productId,\n      size: mappedSize\n    });\n    const response = await fetch(`${BASE_URL}/increase`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        userId,\n        productId,\n        size: mappedSize\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Lỗi khi tăng số lượng');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error increasing quantity:', error.message);\n    throw error;\n  }\n}\n\n// Giảm số lượng sản phẩm\nexport async function decreaseQuantity(userId, productId, size) {\n  try {\n    if (!userId) throw new Error('Thiếu userId');\n    const mappedSize = mapSize(size);\n    console.log('Decreasing quantity:', {\n      userId,\n      productId,\n      size: mappedSize\n    });\n    const response = await fetch(`${BASE_URL}/decrease`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        userId,\n        productId,\n        size: mappedSize\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Lỗi khi giảm số lượng');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error decreasing quantity:', error.message);\n    throw error;\n  }\n}\n\n// Xóa sản phẩm khỏi giỏ hàng\nexport async function removeFromCart(userId, productId, size) {\n  try {\n    if (!userId) throw new Error('Thiếu userId');\n    const mappedSize = mapSize(size);\n    console.log('Removing from cart:', {\n      userId,\n      productId,\n      size: mappedSize\n    });\n    const response = await fetch(`${BASE_URL}/remove`, {\n      method: 'DELETE',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        userId,\n        productId,\n        size: mappedSize\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Lỗi khi xóa sản phẩm');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error removing from cart:', error.message);\n    throw error;\n  }\n}","map":{"version":3,"names":["BASE_URL","mapSize","size","Error","fetchCart","userId","console","log","response","fetch","ok","errorData","json","message","data","error","addToCart","product","productId","quantity","name","price","image","mappedSize","method","headers","body","JSON","stringify","increaseQuantity","decreaseQuantity","removeFromCart"],"sources":["D:/Năm 4 Kì 2/Phát triển hệ thống thương mại điện tử/ecommerce-app/frontend/src/services/CartService.js"],"sourcesContent":["// src/services/CartService.js\r\n\r\nconst BASE_URL = 'http://localhost:5000/api/carts';\r\n\r\n// Hàm ánh xạ size từ giá trị UI (\"25\", \"5\", \"1\") sang giá trị backend (\"0.25\", \"0.5\", \"1\")\r\nconst mapSize = (size) => {\r\n    switch (size) {\r\n        case \"25\": return \"0.25\";\r\n        case \"5\": return \"0.5\";\r\n        case \"1\": return \"1\";\r\n        case \"0.25\": return \"0.25\";\r\n        case \"0.5\": return \"0.5\";\r\n        case \"1.0\": return \"1\";\r\n        default: throw new Error(`Size không hợp lệ: ${size}. Chỉ hỗ trợ \"25\" (0.25kg), \"5\" (0.5kg), \"1\" (1kg)`);\r\n    }\r\n};\r\n\r\n// Lấy giỏ hàng theo userId\r\nexport async function fetchCart(userId) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        console.log('Fetching cart for userId:', userId);\r\n        const response = await fetch(`${BASE_URL}/${userId}`);\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi lấy giỏ hàng');\r\n        }\r\n        const data = await response.json();\r\n        return data;\r\n    } catch (error) {\r\n        console.error('Error fetching cart:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Thêm sản phẩm vào giỏ hàng\r\nexport async function addToCart(userId, product) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const { productId, quantity = 1, size, name, price, image } = product;\r\n        const mappedSize = mapSize(size);\r\n        console.log('Original size:', size, 'Mapped size:', mappedSize);\r\n        console.log('Adding to cart:', { userId, productId, quantity, size: mappedSize, name, price, image });\r\n\r\n        const response = await fetch(`${BASE_URL}/add`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, quantity, size: mappedSize, name, price, image })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi thêm vào giỏ hàng');\r\n        }\r\n\r\n        const data = await response.json();\r\n        console.log('Cart updated:', data);\r\n        return data;\r\n    } catch (error) {\r\n        console.error('Error adding to cart:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Tăng số lượng sản phẩm\r\nexport async function increaseQuantity(userId, productId, size) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const mappedSize = mapSize(size);\r\n        console.log('Increasing quantity:', { userId, productId, size: mappedSize });\r\n\r\n        const response = await fetch(`${BASE_URL}/increase`, {\r\n            method: 'PUT',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, size: mappedSize })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi tăng số lượng');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Error increasing quantity:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Giảm số lượng sản phẩm\r\nexport async function decreaseQuantity(userId, productId, size) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const mappedSize = mapSize(size);\r\n        console.log('Decreasing quantity:', { userId, productId, size: mappedSize });\r\n\r\n        const response = await fetch(`${BASE_URL}/decrease`, {\r\n            method: 'PUT',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, size: mappedSize })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi giảm số lượng');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Error decreasing quantity:', error.message);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Xóa sản phẩm khỏi giỏ hàng\r\nexport async function removeFromCart(userId, productId, size) {\r\n    try {\r\n        if (!userId) throw new Error('Thiếu userId');\r\n        const mappedSize = mapSize(size);\r\n        console.log('Removing from cart:', { userId, productId, size: mappedSize });\r\n\r\n        const response = await fetch(`${BASE_URL}/remove`, {\r\n            method: 'DELETE',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ userId, productId, size: mappedSize })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'Lỗi khi xóa sản phẩm');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Error removing from cart:', error.message);\r\n        throw error;\r\n    }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}