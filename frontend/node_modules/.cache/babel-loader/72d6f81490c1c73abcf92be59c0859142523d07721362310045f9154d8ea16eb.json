{"ast":null,"code":"var _jsxFileName = \"D:\\\\N\\u0103m 4 K\\xEC 2\\\\Ph\\xE1t tri\\u1EC3n h\\u1EC7 th\\u1ED1ng th\\u01B0\\u01A1ng m\\u1EA1i \\u0111i\\u1EC7n t\\u1EED\\\\ecommerce-app\\\\frontend\\\\src\\\\components\\\\RelatedItem.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport AddressService from '../services/AddressService';\nimport \"../styles/RelatedItem.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RelatedItems = ({\n  relatedProducts,\n  currentProductId,\n  addToCart\n}) => {\n  _s();\n  const navigate = useNavigate();\n  const {\n    user\n  } = useAuth();\n  const handleBuyNow = async product => {\n    var _product$prices, _product$prices$;\n    const price = (_product$prices = product.prices) === null || _product$prices === void 0 ? void 0 : (_product$prices$ = _product$prices[\"0\"]) === null || _product$prices$ === void 0 ? void 0 : _product$prices$[\"25\"]; // Giá cho size 0.25kg\n    if (!price) {\n      console.error(\"Lỗi: Không tìm thấy giá sản phẩm\", product);\n      return;\n    }\n    const item = {\n      productId: product._id,\n      name: product.name,\n      price: price,\n      image: product.image,\n      size: \"0.25\",\n      quantity: 1\n    };\n    let selectedAddress = null;\n    if (user && user._id) {\n      try {\n        const addresses = await AddressService.getAddresses(user._id); // Giả định API lấy địa chỉ\n        selectedAddress = addresses.find(addr => addr.isDefault) || addresses[0] || null;\n      } catch (error) {\n        console.error(\"Lỗi khi lấy địa chỉ:\", error);\n      }\n    }\n    navigate(\"/payment\", {\n      state: {\n        selectedItems: [item],\n        total: price * 1,\n        // Tổng tiền cho 1 sản phẩm\n        selectedAddress: selectedAddress ? {\n          fullName: selectedAddress.fullName,\n          address: `${selectedAddress.detail}, ${selectedAddress.ward}, ${selectedAddress.district}, ${selectedAddress.province}`,\n          phone: selectedAddress.phone\n        } : null\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"related-items\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"S\\u1EA3n ph\\u1EA9m c\\xF9ng lo\\u1EA1i\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"related-list\",\n      children: relatedProducts.length > 0 ? relatedProducts.filter(product => product._id !== currentProductId).map(product => {\n        var _product$prices2, _product$prices2$;\n        const currentPrice = (_product$prices2 = product.prices) === null || _product$prices2 === void 0 ? void 0 : (_product$prices2$ = _product$prices2[\"0\"]) === null || _product$prices2$ === void 0 ? void 0 : _product$prices2$[\"25\"];\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"related-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: () => navigate(`/${product.category}/${product._id}`),\n            style: {\n              cursor: 'pointer'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: product.image,\n              alt: product.name,\n              className: \"related-image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"related-name\",\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"related-price\",\n              children: currentPrice ? `${currentPrice.toLocaleString()} VND / 0.25kg` : \"Giá chưa cập nhật\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"related-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-add\",\n              onClick: e => {\n                e.stopPropagation();\n                addToCart({\n                  productId: product._id,\n                  name: product.name,\n                  price: currentPrice,\n                  image: product.image,\n                  size: \"0.25\",\n                  quantity: 1\n                });\n              },\n              children: \"\\uD83D\\uDED2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-buy\",\n              onClick: e => {\n                e.stopPropagation();\n                handleBuyNow(product);\n              },\n              children: \"Mua ngay\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 19\n          }, this)]\n        }, product._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 17\n        }, this);\n      }) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Kh\\xF4ng c\\xF3 s\\u1EA3n ph\\u1EA9m li\\xEAn quan.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n};\n_s(RelatedItems, \"aMAerdHTUl+s1UWmXA6CSCwiXuE=\", false, function () {\n  return [useNavigate, useAuth];\n});\n_c = RelatedItems;\nexport default RelatedItems;\nvar _c;\n$RefreshReg$(_c, \"RelatedItems\");","map":{"version":3,"names":["React","useNavigate","useAuth","AddressService","jsxDEV","_jsxDEV","RelatedItems","relatedProducts","currentProductId","addToCart","_s","navigate","user","handleBuyNow","product","_product$prices","_product$prices$","price","prices","console","error","item","productId","_id","name","image","size","quantity","selectedAddress","addresses","getAddresses","find","addr","isDefault","state","selectedItems","total","fullName","address","detail","ward","district","province","phone","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","filter","map","_product$prices2","_product$prices2$","currentPrice","onClick","category","style","cursor","src","alt","toLocaleString","e","stopPropagation","_c","$RefreshReg$"],"sources":["D:/Năm 4 Kì 2/Phát triển hệ thống thương mại điện tử/ecommerce-app/frontend/src/components/RelatedItem.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport AddressService from '../services/AddressService';\r\nimport \"../styles/RelatedItem.css\";\r\n\r\nconst RelatedItems = ({ relatedProducts, currentProductId, addToCart }) => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n\r\n  const handleBuyNow = async (product) => {\r\n    const price = product.prices?.[\"0\"]?.[\"25\"]; // Giá cho size 0.25kg\r\n    if (!price) {\r\n      console.error(\"Lỗi: Không tìm thấy giá sản phẩm\", product);\r\n      return;\r\n    }\r\n\r\n    const item = {\r\n      productId: product._id,\r\n      name: product.name,\r\n      price: price,\r\n      image: product.image,\r\n      size: \"0.25\",\r\n      quantity: 1,\r\n    };\r\n\r\n    let selectedAddress = null;\r\n    if (user && user._id) {\r\n      try {\r\n        const addresses = await AddressService.getAddresses(user._id); // Giả định API lấy địa chỉ\r\n        selectedAddress = addresses.find((addr) => addr.isDefault) || addresses[0] || null;\r\n      } catch (error) {\r\n        console.error(\"Lỗi khi lấy địa chỉ:\", error);\r\n      }\r\n    }\r\n\r\n    navigate(\"/payment\", {\r\n      state: {\r\n        selectedItems: [item],\r\n        total: price * 1, // Tổng tiền cho 1 sản phẩm\r\n        selectedAddress: selectedAddress\r\n          ? {\r\n              fullName: selectedAddress.fullName,\r\n              address: `${selectedAddress.detail}, ${selectedAddress.ward}, ${selectedAddress.district}, ${selectedAddress.province}`,\r\n              phone: selectedAddress.phone,\r\n            }\r\n          : null,\r\n      },\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"related-items\">\r\n      <h3>Sản phẩm cùng loại</h3>\r\n      <div className=\"related-list\">\r\n        {relatedProducts.length > 0 ? (\r\n          relatedProducts\r\n            .filter(product => product._id !== currentProductId)\r\n            .map(product => {\r\n              const currentPrice = product.prices?.[\"0\"]?.[\"25\"];\r\n\r\n              return (\r\n                <div key={product._id} className=\"related-item\">\r\n                  <div\r\n                    onClick={() => navigate(`/${product.category}/${product._id}`)}\r\n                    style={{ cursor: 'pointer' }}\r\n                  >\r\n                    <img src={product.image} alt={product.name} className=\"related-image\" />\r\n                    <h4 className=\"related-name\">{product.name}</h4>\r\n                    <p className=\"related-price\">\r\n                      {currentPrice\r\n                        ? `${currentPrice.toLocaleString()} VND / 0.25kg`\r\n                        : \"Giá chưa cập nhật\"}\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"related-actions\">\r\n                    <button\r\n                      className=\"btn-add\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        addToCart({\r\n                          productId: product._id,\r\n                          name: product.name,\r\n                          price: currentPrice,\r\n                          image: product.image,\r\n                          size: \"0.25\",\r\n                          quantity: 1,\r\n                        });\r\n                      }}\r\n                    >\r\n                      🛒\r\n                    </button>\r\n                    <button\r\n                      className=\"btn-buy\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleBuyNow(product);\r\n                      }}\r\n                    >\r\n                      Mua ngay\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })\r\n        ) : (\r\n          <p>Không có sản phẩm liên quan.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RelatedItems;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}